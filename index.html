
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Number Validation</title>
    <script>
        async function validateNumber() {
            const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSk8j-ZMvoxK-kaDxnBIBOCwC46Mg4eN7LvK4u5gS4Am3Q8p4JzfZ5saoK5jssFkOIsX-ZMajllUSMw/gviz/tq?tqx=out:json'; // Replace with your JSON URL
            const response = await fetch(sheetUrl);
            const text = await response.text();
            const json = JSON.parse(text.substring(47, text.length - 2)); // Clean Google Sheets JSONP

            const validNumbers = json.table.rows.map(row => row.c[0].v); // Extract valid numbers from column A
            const userNumber = document.getElementById('numberInput').value;

            if (validNumbers.includes(userNumber)) {
                window.location.href = 'https://google.com'; // Replace with your Microsoft Form URL
            } else {
                document.getElementById('errorMessage').innerText = 'You are not eligible to access this form.';
            }
        }
    </script>
</head>
<body>
    <form onsubmit="event.preventDefault(); validateNumber();">
        <label for="numberInput">Enter your number:</label>
        <input type="text" id="numberInput" required>
        <button type="submit">Submit</button>
    </form>
    <p id="errorMessage" style="color:red;"></p>
</body>
</html>
